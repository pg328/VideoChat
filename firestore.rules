rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
  		allow create: if isMine() && hasTimestamp();
  			allow update: if isMine() && hasTimestamp() && isCalm();
  			function isMine() {
  		return request.resource.id == request.auth.uid;
  			}
  			function hasTimestamp() {
  		return request.resource.data.timestamp == request.time;
  		}
  			function isCalm() {
  		return request.time > resource.data.timestamp + duration.value(5, 's');
  			}
			}
    }
  }
